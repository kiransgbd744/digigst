package com.ey.advisory.app.data.daos.client;

import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Component;

import com.ey.advisory.admin.data.repositories.client.GSTNDetailRepository;
import com.ey.advisory.app.data.repositories.client.StatecodeRepository;
import com.ey.advisory.app.services.ret1.Ret1ProcessedRecordsRequestDto;
import com.ey.advisory.app.services.ret1.Ret1ProcessedRecordsResponseDto;
import com.ey.advisory.common.GenUtil;
import com.ey.advisory.core.api.APIConstants;
import com.ey.advisory.gstnapi.services.DefaultGSTNAuthTokenService;

import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;
import jakarta.persistence.Query;

/**
 * 
 * @author Anand3.M
 *
 */
@Component("Ret1ProcessedRecordsDaoImpl")
public class Ret1ProcessedRecordsDaoImpl implements Ret1ProcessedRecordsDao {

	@PersistenceContext(unitName = "clientDataUnit")
	private EntityManager entityManager;

	@Autowired
	@Qualifier("GSTNDetailRepository")
	private GSTNDetailRepository gstnDetailRepository;

	@Autowired
	@Qualifier("StatecodeRepository")
	private StatecodeRepository statecodeRepository;

	@Autowired
	@Qualifier("DefaultGSTNAuthTokenService")
	private DefaultGSTNAuthTokenService defaultGSTNAuthTokenService;

	@SuppressWarnings("unchecked")
	@Override
	public List<Ret1ProcessedRecordsResponseDto> fetchRet1ProcessedRecords(
			List<String> gstins, Ret1ProcessedRecordsRequestDto dto) {
		List<String> criteriaList = buildQueryByCriteria(dto);
		String queryStr = buildRet1QueryString(criteriaList);
		Query q = entityManager.createNativeQuery(queryStr);
		setParameterByCriteria(q, gstins, dto);
		List<Object[]> processedList = q.getResultList();
		return convertObjectIntoRecordsList(processedList);
	}

	private List<Ret1ProcessedRecordsResponseDto> convertObjectIntoRecordsList(
			List<Object[]> processedList) {
		List<Ret1ProcessedRecordsResponseDto> dtos = new ArrayList<>();
		if (processedList != null && processedList.size() > 0) {
			for (Object arr[] : processedList) {
				Ret1ProcessedRecordsResponseDto dto = new Ret1ProcessedRecordsResponseDto();

				String gstin = (String) arr[0];
				dto.setGstin(gstin);
				addStateAndAuthTokenData(dto, gstin);
				dto.setTimestamp(APIConstants.EMPTY);
				dto.setStatus((String) arr[2]);

				// BigDecimal liab = new BigDecimal(String.valueOf(arr[3]));
				// dto.setLiability(liab);
				dto.setLiability(
						arr[4] == null ? BigDecimal.ZERO : (BigDecimal) arr[4]);

				dto.setRevCharge(
						arr[5] == null ? BigDecimal.ZERO : (BigDecimal) arr[5]);
				dto.setOtherCharge(
						arr[6] == null ? BigDecimal.ZERO : (BigDecimal) arr[6]);

				dto.setItc(
						arr[7] == null ? BigDecimal.ZERO : (BigDecimal) arr[7]);
				dto.setTds(
						arr[8] == null ? BigDecimal.ZERO : (BigDecimal) arr[8]);
				dto.setTcs(
						arr[9] == null ? BigDecimal.ZERO : (BigDecimal) arr[9]);

				dtos.add(dto);
			}
		}
		return dtos;
	}

	public void addStateAndAuthTokenData(Ret1ProcessedRecordsResponseDto dto,
			String gstin) {
		String statecode = gstin.substring(0, 2);
		String statename = statecodeRepository.findStateNameByCode(statecode);
		if (statename == null) {
			dto.setState(APIConstants.EMPTY);
		} else {
			dto.setState(statename);
		}
		List<String> regName = gstnDetailRepository.findRegTypeByGstin(gstin);
		if (regName != null && regName.size() > 0) {
			String regTypeName = regName.get(0);
			if (regTypeName == null || regTypeName.equalsIgnoreCase("normal")
					|| regTypeName.equalsIgnoreCase("regular")) {
				dto.setRegType(APIConstants.EMPTY);
			} else {
				dto.setRegType(regTypeName.toUpperCase());
			}
		} else {
			dto.setRegType(APIConstants.EMPTY);
		}

		String gstintoken = defaultGSTNAuthTokenService
				.getAuthTokenStatusForGstin(gstin);
		if (gstintoken != null) {
			if ("A".equalsIgnoreCase(gstintoken)) {
				dto.setAuthToken("Active");
			} else {
				dto.setAuthToken("Inactive");
			}
		} else {
			dto.setAuthToken("Inactive");
		}

	}

	private void setParameterByCriteria(Query q, List<String> gstins,
			Ret1ProcessedRecordsRequestDto dto) {
		q.setParameter("gstins", gstins);
		if (dto.getTaxPeriod() != null
				&& !dto.getTaxPeriod().equals(APIConstants.EMPTY)) {
			q.setParameter("period",
					GenUtil.convertTaxPeriodToInt(dto.getTaxPeriod()));
		}

	}

	private String buildRet1QueryString(List<String> criteriaList) {
		String query = "SELECT GSTIN,DERIVED_RET_PERIOD,STATUS,MAX(STATUS_DATE_TIME) STATUS_DATE_TIME,"
				+ "SUM(RET1_TOTAL_TAX_LIABILITY) RET1_TOTAL_TAX_LIABILITY, SUM(RET1_REVERSECHARGE) RET1_REVERSECHARGE, "
				+ "SUM(RET1_OTHERTHAN_REVERSECHARGE) AS RET1_OTHERTHAN_REVERSECHARGE, SUM(RET1_NET_ITC_AVAILABLE) AS RET1_NET_ITC_AVAILABLE, "
				+ "SUM(RET1_TDS) AS RET1_TDS,SUM(RET1_TCS) AS RET1_TCS "
				+ "FROM( SELECT GSTIN,DERIVED_RET_PERIOD,STATUS,STATUS_DATE_TIME,RET1_TOTAL_TAX_LIABILITY, 0 AS RET1_REVERSECHARGE, "
				+ "0 AS RET1_OTHERTHAN_REVERSECHARGE, 0 AS RET1_NET_ITC_AVAILABLE,0 AS RET1_TDS, 0 AS RET1_TCS "
				+ "FROM ( SELECT SUPPLIER_GSTIN AS GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) THEN 'PARTIALLY SAVED' END AS STATUS, "
				+ "MAX(MODIFIED_ON) AS STATUS_DATE_TIME, (IFNULL(SUM(CASE WHEN DOC_TYPE IN ('INV','RNV') "
				+ "AND AN_TABLE_SECTION IN ('3A','3B','3C','3D','3E','3F','3G') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL(CESS_AMT_ADVALOREM,0) END),0) + IFNULL(SUM(CASE WHEN DOC_TYPE IN ('DR','RDR') "
				+ "AND AN_TABLE_SECTION IN ('3A','3B','3C','3D','3E','3F','3G') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL(CESS_AMT_ADVALOREM,0) END),0) - IFNULL(SUM(CASE WHEN DOC_TYPE IN ('CR','RCR') "
				+ "AND AN_TABLE_SECTION IN ('3A','3B','3C','3D','3E','3F','3G') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL(CESS_AMT_ADVALOREM,0) END),0)) AS RET1_TOTAL_TAX_LIABILITY "
				+ "FROM ANX_OUTWARD_DOC_HEADER "
				+ "WHERE IS_PROCESSED = TRUE AND IS_DELETE = FALSE AND AN_TABLE_SECTION IN ('3A','3B','3C','3D','3E','3F','3G') AND AN_RETURN_TYPE='ANX1' ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(0) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "SUPPLIER_GSTIN, DERIVED_RET_PERIOD "
				+ "UNION ALL "
				+ "SELECT GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and "
				+ "COUNT(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "IFNULL(SUM(IGST_AMT),0)+IFNULL(SUM(CGST_AMT),0)+IFNULL(SUM(SGST_AMT),0)+IFNULL(SUM(CESS_AMT),0) AS RET1_TOTAL_TAX_LIABILITY "
				+ "FROM RET_PROCESSED_USERINPUT "
				+ "WHERE IS_DELETE = FALSE AND RETURN_TYPE='RET-1' AND RETURN_TABLE IN ('3A8') ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(1) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "GSTIN, DERIVED_RET_PERIOD "
				+ "UNION ALL "
				+ "SELECT CUST_GSTIN AS GSTIN,DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "(IFNULL(SUM(CASE WHEN DOC_TYPE='INV' AND AN_TABLE_SECTION IN ('3H','3I') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+IFNULL(CESS_AMT_ADVALOREM,0) END),0) + "
				+ "IFNULL(SUM(CASE WHEN DOC_TYPE='DR' AND AN_TABLE_SECTION IN ('3H','3I') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)"
				+ "+IFNULL(CESS_AMT_ADVALOREM,0) END),0) - IFNULL(SUM(CASE WHEN DOC_TYPE='CR' AND AN_TABLE_SECTION IN ('3H','3I') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL(CESS_AMT_ADVALOREM,0) END),0)) AS RET1_TOTAL_TAX_LIABILITY "
				+ "FROM ANX_INWARD_DOC_HEADER "
				+ "WHERE IS_PROCESSED = TRUE AND IS_DELETE = FALSE AND AN_TABLE_SECTION IN ('3H','3I') AND AN_RETURN_TYPE='ANX1' ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(2) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "CUST_GSTIN, DERIVED_RET_PERIOD "
				+ "UNION ALL "
				+ "SELECT GSTIN,DERIVED_RET_PERIOD, STATUS,STATUS_DATE_TIME,SUM (RET1_TOTAL_TAX_LIABILITY) AS RET1_TOTAL_TAX_LIABILITY "
				+ "FROM ( SELECT SUPPLIER_GSTIN AS GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "(IFNULL(SUM(CASE WHEN DOC_TYPE='DR' THEN IFNULL( IGST_AMT,0)+IFNULL( CGST_AMT,0)+IFNULL( SGST_AMT,0)+"
				+ "IFNULL( CESS_AMT_SPECIFIC,0)+IFNULL( CESS_AMT_ADVALOREM,0) END),0) - IFNULL(SUM(CASE WHEN DOC_TYPE='CR' "
				+ "THEN IFNULL( IGST_AMT,0)+IFNULL( CGST_AMT,0)+IFNULL( SGST_AMT,0)+IFNULL( CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL( CESS_AMT_ADVALOREM,0) END),0)) AS RET1_TOTAL_TAX_LIABILITY "
				+ "FROM ANX_OUTWARD_DOC_HEADER "
				+ "WHERE IS_PROCESSED = TRUE AND IS_DELETE = FALSE AND DOC_TYPE IN ('DR' ,'CR') AND AN_RETURN_TYPE='ANX1' ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(0) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "SUPPLIER_GSTIN, DERIVED_RET_PERIOD "
				+ "UNION ALL "
				+ "SELECT GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "(IFNULL(SUM(CASE WHEN RETURN_TABLE='3C3' THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+"
				+ "IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT,0) END),0) - IFNULL(SUM(CASE WHEN RETURN_TABLE='3C4' "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT,0) END),0) - IFNULL(SUM"
				+ "(CASE WHEN RETURN_TABLE='3C5' THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT,0) END),0)) AS RET1_TOTAL_TAX_LIABILITY "
				+ "FROM RET_PROCESSED_USERINPUT "
				+ "WHERE IS_DELETE = FALSE AND RETURN_TYPE='RET-1' AND RETURN_TABLE IN ('3C3','3C4','3C5') ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(1) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "GSTIN, DERIVED_RET_PERIOD ) "
				+ "GROUP BY "
				+ "GSTIN,DERIVED_RET_PERIOD,STATUS,STATUS_DATE_TIME ) "
				+ "UNION ALL "
				+ "SELECT GSTIN,DERIVED_RET_PERIOD,STATUS,STATUS_DATE_TIME, 0 AS RET1_TOTAL_TAX_LIABILITY, "
				+ "RET1_REVERSECHARGE, 0 AS RET1_OTHERTHAN_REVERSECHARGE, 0 AS RET1_NET_ITC_AVAILABLE,0 AS RET1_TDS, 0 AS RET1_TCS "
				+ "FROM (SELECT CUST_GSTIN AS GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "(IFNULL(SUM(CASE WHEN DOC_TYPE='INV' AND AN_TABLE_SECTION IN ('3H','3I') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL(CESS_AMT_ADVALOREM,0) END),0) + IFNULL(SUM(CASE WHEN DOC_TYPE='DR' AND AN_TABLE_SECTION IN ('3H','3I') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)"
				+ "+IFNULL(CESS_AMT_ADVALOREM,0) END),0) - IFNULL(SUM(CASE WHEN DOC_TYPE='CR' AND AN_TABLE_SECTION IN ('3H','3I') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+IFNULL(CESS_AMT_ADVALOREM,0) END),0)) AS RET1_REVERSECHARGE "
				+ "FROM ANX_INWARD_DOC_HEADER "
				+ "WHERE IS_PROCESSED = TRUE AND IS_DELETE = FALSE AND AN_TABLE_SECTION IN ('3H','3I') AND AN_RETURN_TYPE='ANX1' ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(2) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "CUST_GSTIN, DERIVED_RET_PERIOD ) "
				+ "UNION ALL "
				+ "SELECT GSTIN,DERIVED_RET_PERIOD,STATUS,STATUS_DATE_TIME, 0 AS RET1_TOTAL_TAX_LIABILITY, "
				+ "0 AS RET1_REVERSECHARGE, RET1_OTHERTHAN_REVERSECHARGE, 0 AS RET1_NET_ITC_AVAILABLE,0 AS RET1_TDS, 0 AS RET1_TCS "
				+ "FROM (SELECT SUPPLIER_GSTIN AS GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "(IFNULL(SUM(CASE WHEN DOC_TYPE='INV' AND AN_TABLE_SECTION IN ('3A','3B','3C','3D','3E','3F','3G') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+IFNULL(CESS_AMT_ADVALOREM,0) END),0) + "
				+ "IFNULL(SUM(CASE WHEN DOC_TYPE='DR' AND AN_TABLE_SECTION IN ('3A','3B','3C','3D','3E','3F','3G') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL(CESS_AMT_ADVALOREM,0) END),0) - IFNULL(SUM(CASE WHEN DOC_TYPE='CR' "
				+ "AND AN_TABLE_SECTION IN ('3A','3B','3C','3D','3E','3F','3G') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL(CESS_AMT_ADVALOREM,0) END),0)) AS RET1_OTHERTHAN_REVERSECHARGE "
				+ "FROM ANX_OUTWARD_DOC_HEADER "
				+ "WHERE IS_PROCESSED = TRUE AND IS_DELETE = FALSE AND AN_TABLE_SECTION IN ('3A','3B','3C','3D','3E','3F','3G') AND AN_RETURN_TYPE='ANX1' ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(0) : APIConstants.EMPTY);
		query = query + "GROUP BY "
				+ "SUPPLIER_GSTIN, DERIVED_RET_PERIOD UNION ALL SELECT GSTIN, DERIVED_RET_PERIOD, "
				+ "CASE WHEN(COUNT(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "IFNULL(SUM(IGST_AMT),0)+IFNULL(SUM(CGST_AMT),0)+IFNULL(SUM(SGST_AMT),0)+IFNULL(SUM(CESS_AMT),0) AS RET1_OTHERTHAN_REVERSECHARGE "
				+ "FROM RET_PROCESSED_USERINPUT "
				+ "WHERE IS_DELETE = FALSE AND RETURN_TYPE='RET-1' AND RETURN_TABLE IN ('3A8') ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(1) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "GSTIN, DERIVED_RET_PERIOD "
				+ "UNION ALL "
				+ "SELECT GSTIN,DERIVED_RET_PERIOD, STATUS,MAX(STATUS_DATE_TIME) STATUS_DATE_TIME,SUM (RET1_OTHERTHAN_REVERSECHARGE) AS RET1_OTHERTHAN_REVERSECHARGE "
				+ "FROM ( SELECT SUPPLIER_GSTIN AS GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "(IFNULL(SUM(CASE WHEN DOC_TYPE='DR' THEN IFNULL( IGST_AMT,0)+IFNULL( CGST_AMT,0)+IFNULL( SGST_AMT,0)+"
				+ "IFNULL( CESS_AMT_SPECIFIC,0)+IFNULL( CESS_AMT_ADVALOREM,0) END),0) - IFNULL(SUM(CASE WHEN DOC_TYPE='CR' "
				+ "THEN IFNULL( IGST_AMT,0)+IFNULL( CGST_AMT,0)+IFNULL( SGST_AMT,0)+IFNULL( CESS_AMT_SPECIFIC,0)+"
				+ "IFNULL( CESS_AMT_ADVALOREM,0) END),0)) AS RET1_OTHERTHAN_REVERSECHARGE "
				+ "FROM ANX_OUTWARD_DOC_HEADER "
				+ "WHERE IS_PROCESSED = TRUE AND IS_DELETE = FALSE AND DOC_TYPE IN ('DR' ,'CR') AND AN_RETURN_TYPE='ANX1' ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(0) : APIConstants.EMPTY);
		query = query

				+ "GROUP BY " + "SUPPLIER_GSTIN, DERIVED_RET_PERIOD "
				+ "UNION ALL "
				+ "SELECT GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and "
				+ "COUNT(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "(IFNULL(SUM(CASE WHEN RETURN_TABLE='3C3' THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)"
				+ "+IFNULL(CESS_AMT,0) END),0) - IFNULL(SUM(CASE WHEN RETURN_TABLE='3C4' THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)"
				+ "+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT,0) END),0) - IFNULL(SUM(CASE WHEN RETURN_TABLE='3C5' THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)"
				+ "+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT,0) END),0)) AS RET1_OTHERTHAN_REVERSECHARGE "
				+ "FROM RET_PROCESSED_USERINPUT "
				+ "WHERE IS_DELETE = FALSE AND RETURN_TYPE='RET-1' AND RETURN_TABLE IN ('3C3','3C4','3C5') ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(1) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "GSTIN, DERIVED_RET_PERIOD ) "
				+ "GROUP BY " + "GSTIN,DERIVED_RET_PERIOD,STATUS ) "
				+ "UNION ALL "
				+ "SELECT GSTIN,DERIVED_RET_PERIOD,STATUS,STATUS_DATE_TIME, 0 AS RET1_TOTAL_TAX_LIABILITY, "
				+ "0 AS RET1_REVERSECHARGE, 0 AS RET1_OTHERTHAN_REVERSECHARGE, RET1_NET_ITC_AVAILABLE,0 AS RET1_TDS, "
				+ "0 AS RET1_TCS FROM ( SELECT GSTIN,DERIVED_RET_PERIOD,STATUS,MAX(STATUS_DATE_TIME) STATUS_DATE_TIME,"
				+ "SUM(RET1_NET_ITC_AVAILABLE) RET1_NET_ITC_AVAILABLE "
				+ "FROM (SELECT CUST_GSTIN AS GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) THEN 'SAVED' "
				+ "WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, "
				+ "(IFNULL(SUM(CASE WHEN DOC_TYPE='INV' AND AN_TABLE_SECTION IN ('3H','3I','3J','3K','4A10','4A11') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)+IFNULL(CESS_AMT_ADVALOREM,0) END),0) + "
				+ "IFNULL(SUM(CASE WHEN DOC_TYPE='DR' AND AN_TABLE_SECTION IN ('3H','3I','3J','3K','4A10','4A11') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)"
				+ "+IFNULL(CESS_AMT_ADVALOREM,0) END),0) - IFNULL(SUM(CASE WHEN DOC_TYPE='CR' "
				+ "AND AN_TABLE_SECTION IN ('3H','3I','3J','3K','4A10','4A11') THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)"
				+ "+IFNULL(CESS_AMT_SPECIFIC,0)+IFNULL(CESS_AMT_ADVALOREM,0) END),0))- (IFNULL(SUM(CASE WHEN DOC_TYPE='INV' "
				+ "AND AN_TABLE_SECTION IN ('4B2','4B3') THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)"
				+ "+IFNULL(CESS_AMT_SPECIFIC,0)+IFNULL(CESS_AMT_ADVALOREM,0) END),0) "
				+ "+ IFNULL(SUM(CASE WHEN DOC_TYPE='DR' AND AN_TABLE_SECTION IN ('4B2','4B3') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)"
				+ "+IFNULL(CESS_AMT_ADVALOREM,0) END),0) - IFNULL(SUM(CASE WHEN DOC_TYPE='CR' AND AN_TABLE_SECTION IN ('4B2','4B3') "
				+ "THEN IFNULL(IGST_AMT,0)+IFNULL(CGST_AMT,0)+IFNULL(SGST_AMT,0)+IFNULL(CESS_AMT_SPECIFIC,0)"
				+ "+IFNULL(CESS_AMT_ADVALOREM,0) END),0)) AS RET1_NET_ITC_AVAILABLE "
				+ "FROM ANX_INWARD_DOC_HEADER "
				+ "WHERE IS_PROCESSED = TRUE AND IS_DELETE = FALSE "
				+ "AND AN_TABLE_SECTION IN ('3H','3I','3J','3K','4A10','4A11','4B2','4B3') ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(2) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "CUST_GSTIN, DERIVED_RET_PERIOD "
				+ "UNION ALL "
				+ "SELECT GSTIN, DERIVED_RET_PERIOD, CASE WHEN(COUNT"
				+ "(CASE WHEN IS_SENT_TO_GSTN=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0 and COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN=true AND IS_DELETE=FALSE THEN 1 ELSE NULL END) = 0) "
				+ "THEN 'NOT INTTIATED' "
				+ "WHEN (COUNT(CASE WHEN IS_DELETE=FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN GSTN_ERROR=TRUE AND IS_DELETE=FALSE THEN 1 ELSE NULL END)) THEN 'FAILED' "
				+ "WHEN (COUNT(CASE when IS_DELETE = FALSE THEN 1 ELSE NULL END) = COUNT"
				+ "(CASE WHEN IS_SAVED_TO_GSTN =TRUE AND IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'SAVED' WHEN (COUNT(CASE WHEN IS_SAVED_TO_GSTN=TRUE AND IS_DELETE = FALSE then 1 ELSE NULL END) < COUNT"
				+ "(CASE WHEN IS_DELETE = FALSE THEN 1 ELSE NULL END)) "
				+ "THEN 'PARTIALLY SAVED' END AS STATUS, MAX(MODIFIED_ON) AS STATUS_DATE_TIME, (IFNULL(SUM"
				+ "(CASE WHEN RETURN_TABLE IN ('4A4','4A10','4A11') THEN IFNULL( IGST_AMT,0)+IFNULL( CGST_AMT,0)"
				+ "+IFNULL( SGST_AMT,0)+IFNULL( CESS_AMT,0) END),0) - IFNULL(SUM(CASE WHEN RETURN_TABLE IN ('4B2','4B3','4B4','4B4') "
				+ "THEN IFNULL( IGST_AMT,0)+IFNULL( CGST_AMT,0)+IFNULL( SGST_AMT,0)+IFNULL( CESS_AMT,0) END),0)) AS RET1_NET_ITC_AVAILABLE "
				+ "FROM RET_PROCESSED_USERINPUT "
				+ "WHERE IS_DELETE = FALSE AND RETURN_TYPE='RET-1' AND RETURN_TABLE IN ('4A4','4A10','4A11','4B2','4B3','4B4','4B4') ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(1) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "GSTIN, DERIVED_RET_PERIOD ) "
				+ "GROUP BY " + "GSTIN,DERIVED_RET_PERIOD,STATUS) "
				+ "UNION ALL "
				+ "SELECT GSTIN,DERIVED_RET_PERIOD,STATUS,STATUS_DATE_TIME,0 AS RET1_TOTAL_TAX_LIABILITY, 0 AS RET1_REVERSECHARGE, "
				+ "0 AS RET1_OTHERTHAN_REVERSECHARGE, 0 AS RET1_NET_ITC_AVAILABLE,RET1_TDS, 0 AS RET1_TCS "
				+ "FROM (SELECT GSTIN, DERIVED_RET_PERIOD,'' STATUS,MAX(MODIFIED_ON) AS STATUS_DATE_TIME, IFNULL(SUM(TDS.IGST_AMT),0)"
				+ "+IFNULL(SUM(TDS.CGST_AMT),0)+IFNULL(SUM(TDS.SGST_AMT),0) AS RET1_TDS "
				+ "FROM GETRET1_TABLE5 TDS "
				+ "WHERE IS_DELETE = FALSE AND GET_TABLE_SECTION IN ('TDS') ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(1) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "GSTIN, DERIVED_RET_PERIOD) "
				+ "UNION ALL "
				+ "SELECT GSTIN,DERIVED_RET_PERIOD,STATUS,STATUS_DATE_TIME,0 AS RET1_TOTAL_TAX_LIABILITY, 0 AS RET1_REVERSECHARGE, "
				+ "0 AS RET1_OTHERTHAN_REVERSECHARGE, 0 AS RET1_NET_ITC_AVAILABLE,0 AS RET1_TDS, RET1_TCS "
				+ "FROM (SELECT GSTIN, DERIVED_RET_PERIOD, '' STATUS,MAX(MODIFIED_ON) AS STATUS_DATE_TIME, IFNULL(SUM(TCS.IGST_AMT),0)"
				+ "+IFNULL(SUM(TCS.CGST_AMT),0)+IFNULL(SUM(TCS.SGST_AMT),0) AS RET1_TCS "
				+ "FROM GETRET1_TABLE5 TCS "
				+ "WHERE IS_DELETE = FALSE AND GET_TABLE_SECTION IN ('TCS') ";
		query = query + (criteriaList != null && criteriaList.size() > 0
				? criteriaList.get(1) : APIConstants.EMPTY);
		query = query + "GROUP BY " + "GSTIN, DERIVED_RET_PERIOD) ) "
				+ "GROUP BY " + "GSTIN,DERIVED_RET_PERIOD,STATUS "
				+ "ORDER BY STATUS_DATE_TIME DESC LIMIT 1 ";
		return query;
	}

	private List<String> buildQueryByCriteria(
			Ret1ProcessedRecordsRequestDto dto) {
		String supGstin = " AND SUPPLIER_GSTIN in :gstins ";
		String gstin = " AND GSTIN in :gstins ";
		String custGstin = " AND CUST_GSTIN in :gstins ";
		if (dto.getTaxPeriod() != null
				&& !dto.getTaxPeriod().equals(APIConstants.EMPTY)) {
			supGstin = supGstin + " AND DERIVED_RET_PERIOD = :period ";
			gstin = gstin + " AND DERIVED_RET_PERIOD = :period ";
			custGstin = custGstin + " AND DERIVED_RET_PERIOD = :period ";
		}
		List<String> criteriaList = Arrays.asList(supGstin, gstin, custGstin);
		return criteriaList;
	}

}
